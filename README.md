# image-optimisation-tools-comparison

Generates JSON data comparing the file size savings and quality loss of popular image optimisation
tools

## Installation

```bash
npm install image-optimisation-tools-comparison
```

## Dependencies

### ImageMagick

This project uses [`compare`](http://www.imagemagick.org/script/compare.php) from
[ImageMagick](http://www.imagemagick.org/), so you will need to have that installed.

If you encounter errors related to `dyld library not loaded`, this is also related to your
environment and installation of ImageMagick and will need resolving before you are ready to begin.

## Usage

This module is required in the normal way.

```javascript
var comparison = require('image-optimisation-tools-comparison');
```

### Accessing The Data

To access the data generated by the last run of the comparison, use `comparison.results`.

```javascript
comparison.results()
  .then(function(results) {
    // data
  });
```

### Running A New Comparison

To re-run the comparison then access the new data, use `comparison.compare`.

```javascript
comparison.compare()
  .then(function(results) {
    // data
  });
```

### `results` Object

`comparison.results` and `comparison.compare` both return a promise for a `results` Object, which
contains the following members.

+ [`results.Images`](https://github.com/JamieMason/image-optimisation-tools-comparison/blob/master/data/raw/Images.json)
+ [`results.ImagesByTool`](https://github.com/JamieMason/image-optimisation-tools-comparison/blob/master/data/raw/ImagesByTool.json)
+ [`results.ImagesByName`](https://github.com/JamieMason/image-optimisation-tools-comparison/blob/master/data/raw/ImagesByName.json)
+ [`results.ImagesByToolByName`](https://github.com/JamieMason/image-optimisation-tools-comparison/blob/master/data/raw/ImagesByToolByName.json)
+ [`results.ImagesByNameByTool`](https://github.com/JamieMason/image-optimisation-tools-comparison/blob/master/data/raw/ImagesByNameByTool.json)

Every result is in the following format.

```javascript
{
  "name": "jpeg-progressive_logo.jpg",
  "tool": "jpegmini-and-imageoptim",
  "type": "jpeg-progressive",
  "meanErrorSquared": 2.69691,
  "qualityLossPercent": 4.09806820616539,
  "size": 25731,
  "sizeSaving": 24748,
  "sizeSavingPercent": 49.02632777986886
}
```

## Reference images

### images/photoshop

These are exported from a .psd kindly given to us by
[Daan Jobsis](http://www.twitter.com./daanjobsis) from his tests carried out for the article
[Retina Revolution: Follow Up](http://blog.netvlies.nl/design-interactie/retina-revolutie-follow-up/),
containing photographs of varying levels of detail, simple patterns, and logos.

The images are exported using "Save for Web" as;

+ GIF (+Interlaced).
+ JPEG (+Optimised, Progressive).
+ PNG 8 (+Interlaced).
+ PNG 24 (+Interlaced).

### images/worst

This directory starts as a copy of `images/photoshop` which is then compressed to the worst possible
image quality. This value lets us calculate the quality loss percentage for each image.

## Optimised Images

All directories start as a copy of `images/photoshop` which is then;

### images/codekit

Compressed using https://incident57.com/codekit/.

### images/grunt-contrib-imagemin

Compressed using `grunt imagemin`.

### images/imagealpha-and-imageoptim

Compressed using `grunt imageoptim:imageAlphaAndImageOptim`.

### images/imageoptim

Compressed using `grunt imageoptim:ImageOptimAlone`.

### images/image_optim

Compressed using `image_optim -r images/image_optim --jpegtran-jpegrescan=true`.

### images/image_optim-lossy

Compressed using `image_optim -r images/image_optim-lossy --jpegtran-jpegrescan=true --allow-lossy`.

### images/jpegmini-and-imageoptim

Compressed using `grunt imageoptim:jpegMiniAndImageOptim`.

### images/kraken

Uploaded using the File Uploader at https://kraken.io/web-interface. The Zip file is then
downloaded and extracted into this directory.

### images/smushit

Uploaded one-by-one using the Uploader view at http://www.smushit.com/ysmush.it. The Zip file is
then downloaded and extracted into this directory.

### images/tinypng

Uploaded in batches of 20 at a time using the uploader at https://tinypng.com, downloaded
one-by-one then moved into this directory.
